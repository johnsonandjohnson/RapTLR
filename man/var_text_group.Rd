% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/var_text_group.R
\name{var_text_group}
\alias{var_text_group}
\title{Generate Grouped Variable Summary Text for TLR Reports}
\usage{
var_text_group(
  arg_text_desc = "",
  arg_dataset,
  arg_fl_rest = NULL,
  arg_var_rest,
  arg_group_var,
  arg_group_vals = NULL,
  arg_group_lbl = NULL,
  arg_order = TRUE,
  arg_cvt_stg = I,
  arg_nbr_obs = Inf
)
}
\arguments{
\item{arg_text_desc}{Character string. Optional descriptive text to prepend to the
generated summary. Default is an empty string.}

\item{arg_dataset}{Data frame. The dataset containing the variables to summarize.}

\item{arg_fl_rest}{Unquoted expression. Optional filter condition to subset the dataset
before analysis. Default is NULL (no filtering).}

\item{arg_var_rest}{Unquoted variable name. The categorical variable to summarize
(e.g., adverse event term, discontinuation reason).}

\item{arg_group_var}{Unquoted variable name. The grouping variable (e.g., treatment arm,
study site).}

\item{arg_group_vals}{Character vector. Optional subset of group values to include in
the analysis. If NULL, all groups are included. Default is NULL.}

\item{arg_group_lbl}{Character vector. Optional custom labels for groups, corresponding
to \code{arg_group_vals}. If NULL, original group values are used as labels. Default is NULL.}

\item{arg_order}{Logical. If TRUE, orders results by descending overall frequency.
If FALSE, maintains original variable order. Default is TRUE.}

\item{arg_cvt_stg}{Function. Transformation function to apply to variable labels.
Default is \code{I} (identity function, no transformation). Use \code{tolower}, \code{toupper}, or
custom functions to modify label formatting.}

\item{arg_nbr_obs}{Numeric. Maximum number of categories to include in the output text.
Default is Inf (all categories).}
}
\value{
A character string containing the formatted summary text with percentages and
group distributions.
}
\description{
Creates formatted narrative text summarizing the distribution of a categorical variable
across different groups. Particularly useful for generating dynamic text in Top-Line
Reports (TLR) that describes patient characteristics, or other categorical
outcomes by treatment group or other stratification variables.
}
\details{
The function calculates:
\itemize{
\item Overall percentage of subjects with each category
\item Within-category distribution across groups
\item Formatted narrative text combining these statistics
}
}
\examples{
# Example 1: Basic usage - summarize discontinuation reasons by treatment
# Shows all discontinuation reasons ordered by frequency
var_text_group(
  arg_dataset = tlr_adsl,
  arg_var_rest = DCREASCD,
  arg_group_var = TRT01P
)

# Example 2: Add descriptive text prefix
# Prepends custom text to the generated summary
var_text_group(
  arg_text_desc = "The most common reasons for discontinuation were:",
  arg_dataset = tlr_adsl,
  arg_var_rest = DCREASCD,
  arg_group_var = TRT01P
)

# Example 3: Disable ordering to maintain original variable order
# Useful when variable has inherent ordering (e.g., severity grades)
var_text_group(
  arg_dataset = tlr_adsl,
  arg_var_rest = DCREASCD,
  arg_group_var = TRT01P,
  arg_order = FALSE
)

# Example 4: Limit to specific treatment groups
# Excludes placebo group from the analysis
var_text_group(
  arg_dataset = tlr_adsl,
  arg_var_rest = DCREASCD,
  arg_group_var = TRT01P,
  arg_group_vals = c("Xanomeline High Dose", "Xanomeline Low Dose")
)

# Example 5: Use custom group labels for cleaner output
# Shortens long treatment names for readability
var_text_group(
  arg_dataset = tlr_adsl,
  arg_var_rest = DCREASCD,
  arg_group_var = TRT01P,
  arg_group_vals = c("Xanomeline High Dose", "Xanomeline Low Dose", "Placebo"),
  arg_group_lbl = c("High Dose", "Low Dose", "Placebo")
)

# Example 6: Limit output to top N categories
# Shows only the 3 most common discontinuation reasons
var_text_group(
  arg_dataset = tlr_adsl,
  arg_var_rest = DCREASCD,
  arg_group_var = TRT01P,
  arg_group_vals = c("Xanomeline High Dose", "Xanomeline Low Dose", "Placebo"),
  arg_nbr_obs = 3
)

# Example 7: Apply text transformation to variable labels
# Converts labels to lowercase for consistent formatting
var_text_group(
  arg_dataset = tlr_adsl,
  arg_var_rest = DCREASCD,
  arg_group_var = TRT01P,
  arg_cvt_stg = tolower,
  arg_nbr_obs = 2
)


# Example 8: Combine multiple parameters for precise control
# Filtered data, custom labels, limited output, with descriptive text
var_text_group(
  arg_text_desc = "Among safety population patients,",
  arg_dataset = tlr_adsl,
  arg_fl_rest = SAFFL == "Y",
  arg_var_rest = DCREASCD,
  arg_group_var = TRT01P,
  arg_group_vals = c("Xanomeline High Dose", "Xanomeline Low Dose", "Placebo"),
  arg_group_lbl = c("XAN-H", "XAN-L", "PBO"),
  arg_order = TRUE,
  arg_nbr_obs = 5
)

# Example 9: Analyze adverse events by treatment group
# Useful for safety summaries in TLR documents
var_text_group(
  arg_text_desc = "The most frequently reported adverse events were:",
  arg_dataset = tlr_adae,
  arg_fl_rest = AESEV == "SEVERE",
  arg_var_rest = AEDECOD,
  arg_group_var = TRTA,
  arg_nbr_obs = 5
)

}
\seealso{
\code{\link{textReplace}} for inserting generated text into Word documents
\code{\link{run_apdx}} for adding appendices to TLR documents
}
