[["index.html", "RapTLR Training Guide Rapid Top-Line Report Generation with R Chapter 1 Introduction 1.1 What is RapTLR? 1.2 Why Use RapTLR? 1.3 Installation 1.4 Getting Started with Examples 1.5 Typical Workflow 1.6 Package Dependencies", " RapTLR Training Guide Rapid Top-Line Report Generation with R RapTLR Development Team 2026-01-12 Chapter 1 Introduction 1.1 What is RapTLR? RapTLR (pronounced “raptor”) is an R package designed to automate and streamline the creation of Top-Line Reports (TLRs) in clinical trials. It eliminates manual, error-prone tasks by: Automatically appending TLFs (Tables, Listings, Figures) to Word documents with hyperlinks Dynamically replacing placeholder text with calculated values from your data Creating formatted text descriptions of variable distributions 1.2 Why Use RapTLR? Traditional TLR creation involves: Manual copy-pasting of outputs into Word documents Manually updating numbers when data changes Risk of transcription errors Time-consuming formatting RapTLR solves these problems by connecting your R analysis directly to your Word document, ensuring accuracy and saving hours of work. 1.3 Installation # Install remotes if needed install.packages(&quot;remotes&quot;) # Install RapTLR from GitHub library(remotes) remotes::install_github(&quot;johnsonandjohnson/RapTLR&quot;) 1.4 Getting Started with Examples RapTLR includes built-in examples to help you learn quickly: library(RapTLR) # Export example files to your working directory export_examples(path_workingFolder = &quot;C:/Documents/TLR_folder/&quot;) This creates two folders: - TLF_outputs/ - Contains dummy TLF files (PDFs) - TLR_shell/ - Contains a template Word document 1.5 Typical Workflow # 1. Load your data and create TLFs # 2. Prepare a Word shell document with placeholders # 3. Use run_apdx() to add TLFs as appendices # 4. Use textReplace() to update placeholder text # 5. Generate final TLR document 1.6 Package Dependencies RapTLR relies on the officer package for Word document manipulation. Key concepts: Documents are R objects that can be modified Changes can be chained together Final output is written to a file Let’s dive into each component! "],["tlr-shell.html", "Chapter 2 TLR Shell Preparation 2.1 What is a TLR Shell? 2.2 Creating Your Shell Document 2.3 Best Practices 2.4 Common Mistakes to Avoid", " Chapter 2 TLR Shell Preparation 2.1 What is a TLR Shell? A TLR shell is a template Word document that contains: Pre-written narrative sections Placeholder keywords for dynamic content A marker for where appendices should be inserted Proper formatting and styling Think of it as a “fill-in-the-blanks” document that RapTLR will complete automatically. 2.2 Creating Your Shell Document 2.2.1 Step 1: Write Your Narrative Create a Word document with your standard TLR structure: Study XYZ Top-Line Results 1. Executive Summary [Your summary text here] 2. Study Population TTsubjectTT 3. Efficacy Results TTsomethingTT 4. Safety Results TTsomething2TT 5. Appendices LISTOFAPPENDICES 2.2.2 Step 2: Add Placeholder Keywords CRITICAL RULES for placeholders: Each keyword must be on its own line Correct: Keyword on separate line Wrong: Inline with other text Use distinctive, searchable keywords Good examples: TTsubjectTT, EFFICACY_RATE, N_SAFETY_POP Avoid common words that might appear elsewhere Document your keywords Keep a list of what each placeholder represents Use consistent naming conventions 2.2.3 Step 3: Add Appendix Marker Insert a keyword where you want TLFs to appear: ## Appendices LISTOFAPPENDICES This keyword will be replaced with a formatted list of all your TLFs with hyperlinks. 2.3 Best Practices 2.3.1 Naming Conventions Use prefixes to organize placeholders: TT...TT - For text replacements N_... - For counts PCT_... - For percentages RESULT_... - For analysis results 2.3.2 Version Control Keep your shell document in version control Use meaningful filenames: TLR_shell_v1.0.docx Document changes to placeholder keywords 2.4 Common Mistakes to Avoid Inline placeholders - Always put keywords on separate lines Duplicate keywords - Each placeholder should be unique Missing appendix marker - Don’t forget LISTOFAPPENDICES Your shell is now ready for RapTLR processing! "],["output-conversion.html", "Chapter 3 Output Conversion with 3C Helper 3.1 Understanding TLF Formats 3.2 What is 3C Helper? 3.3 File Naming Conventions 3.4 Organizing Your TLF Folder 3.5 Quality Checks Before Processing", " Chapter 3 Output Conversion with 3C Helper 3.1 Understanding TLF Formats RapTLR’s run_apdx() function inserts TLFs into your Word document. To work properly, your outputs must be in PDF format. 3.2 What is 3C Helper? 3C Helper is a companion tool that converts various output formats to PDF. Common scenarios: RTF files from SAS to PDF HTML files from R to PDF Text listings to PDF Multiple formats in batch 3.3 File Naming Conventions Critical for RapTLR: Use consistent, meaningful names: Good: t_demographics_01.pdf, l_adverse_events_01.pdf Bad: output1.pdf, table.pdf, final_v2.pdf 3.3.1 Recommended Naming Pattern [type]_[description]_[number].pdf Where: - type: t (table), l (listing), f (figure) - description: brief content description - number: sequential identifier 3.4 Organizing Your TLF Folder Create a clear folder structure: TLR_project/ ├── TLF_outputs/ │ ├── t_demographics_01.pdf │ ├── t_efficacy_02.pdf │ └── l_adverse_events_01.pdf ├── TLR_shell/ │ └── TLR_shell.docx └── scripts/ └── generate_tlr.R 3.5 Quality Checks Before Processing Before using run_apdx(), verify: All files are PDFs list.files(&quot;TLF_outputs/&quot;, pattern = &quot;\\\\.pdf$&quot;) Files open correctly Consistent naming Complete set You’re ready to move to appendix creation! "],["appendix-creation.html", "Chapter 4 Appendix Creation 4.1 The run_apdx() Function 4.2 Basic Usage 4.3 Function Parameters 4.4 Organizing with Sections 4.5 Working with Officer Objects 4.6 Best Practices", " Chapter 4 Appendix Creation 4.1 The run_apdx() Function The run_apdx() function automatically: Reads all PDF files from a specified folder Inserts them into your Word document Creates a table of contents with hyperlinks Organizes outputs into sections (optional) 4.2 Basic Usage library(RapTLR) run_apdx( path_TLFs = &quot;C:/Documents/TLR_folder/TLF_outputs&quot;, docx_object = &quot;C:/Documents/TLR_folder/TLR_shell.docx&quot;, keyword = &quot;LISTOFAPPENDICES&quot;, return_to_file = &quot;C:/Documents/TLR_folder/TLR_final.docx&quot; ) 4.3 Function Parameters 4.3.1 Required Parameters path_TLFs - Path to folder containing PDF files docx_object - Path to your shell Word document OR an existing officer object keyword - Placeholder text to replace with appendix list 4.3.2 Optional Parameters return_to_file - Path where final document should be saved sections_structure - Organizes TLFs into sections (list, data frame, or CSV) 4.4 Organizing with Sections 4.4.1 Method 1: Using a List output_list &lt;- list( &quot;Efficacy Tables&quot; = c(&quot;t_efficacy_01&quot;, &quot;t_efficacy_02&quot;), &quot;Safety Tables&quot; = c(&quot;t_adverse_events_01&quot;, &quot;t_labs_01&quot;), &quot;Listings&quot; = c(&quot;l_deaths_01&quot;, &quot;l_serious_ae_01&quot;) ) run_apdx( path_TLFs = &quot;TLF_outputs/&quot;, docx_object = &quot;TLR_shell.docx&quot;, keyword = &quot;LISTOFAPPENDICES&quot;, sections_structure = output_list, return_to_file = &quot;TLR_final.docx&quot; ) 4.4.2 Method 2: Using a CSV File Create TLF_structure.csv: Section,TLF_Name Efficacy Tables,t_efficacy_01 Safety Tables,t_adverse_events_01 Then use it: run_apdx( path_TLFs = &quot;TLF_outputs/&quot;, docx_object = &quot;TLR_shell.docx&quot;, keyword = &quot;LISTOFAPPENDICES&quot;, sections_structure = &quot;TLF_structure.csv&quot;, return_to_file = &quot;TLR_final.docx&quot; ) 4.5 Working with Officer Objects # Add appendices without writing to file doc &lt;- run_apdx( path_TLFs = &quot;TLF_outputs/&quot;, docx_object = &quot;TLR_shell.docx&quot;, keyword = &quot;LISTOFAPPENDICES&quot; ) # Continue processing doc &lt;- textReplace(doc, keyword = &quot;TTsubjectTT&quot;, replacement = &quot;500 patients&quot;) # Write when done print(doc, target = &quot;TLR_final.docx&quot;) 4.6 Best Practices Test with a subset first Keep backups Use version control Document your structure Validate output Your appendices are now automatically inserted! "],["text-replacement.html", "Chapter 5 Dynamic Text Replacement 5.1 The textReplace() Function 5.2 Why Use Dynamic Text? 5.3 Basic Usage 5.4 Function Parameters 5.5 CRITICAL: Officer In-Place Modification 5.6 Chaining Multiple Replacements 5.7 Practical Examples 5.8 Complete Workflow Example 5.9 Combining with run_apdx() 5.10 Best Practices", " Chapter 5 Dynamic Text Replacement 5.1 The textReplace() Function RapTLR’s second “killer feature” allows you to replace placeholder keywords with dynamically calculated values from your R analysis. 5.2 Why Use Dynamic Text? Traditional approach: - Run analysis in R - Manually copy numbers into Word - Data changes → manually update all numbers RapTLR approach: - Write shell with placeholders - Calculate values in R - Automatically replace all placeholders - Data changes → re-run script, done! 5.3 Basic Usage library(RapTLR) n_safety &lt;- 500 new_text &lt;- paste0(&quot;The safety population included &quot;, n_safety, &quot; participants.&quot;) textReplace( doc_object = &quot;TLR_shell.docx&quot;, keyword = &quot;TTsubjectTT&quot;, replacement = new_text, return_to_file = &quot;TLR_updated.docx&quot; ) 5.4 Function Parameters doc_object - Path to Word document OR officer object keyword - Placeholder text to find and replace (must be on its own line) replacement - New text to insert return_to_file - Optional: path to save result 5.5 CRITICAL: Officer In-Place Modification Important behavior: # This does NOT work as expected! x &lt;- read_docx(&quot;shell.docx&quot;) y &lt;- x # y points to same object as x x &lt;- textReplace(x, keyword = &quot;TTtest&quot;, replacement = &quot;New text&quot;) # Both x AND y are now modified! # Trying to replace same keyword twice will fail Solution: Chain operations or use fresh document each time. 5.6 Chaining Multiple Replacements 5.6.1 Method 1: Base R Pipe textReplace( doc_object = &quot;TLR_shell.docx&quot;, keyword = &quot;TTsubjectTT&quot;, replacement = &quot;500 participants enrolled&quot; ) |&gt; textReplace( keyword = &quot;TTsomethingTT&quot;, replacement = &quot;Primary endpoint was met&quot; ) |&gt; textReplace( keyword = &quot;TTsomething2TT&quot;, replacement = &quot;Safety profile was acceptable&quot;, return_to_file = &quot;TLR_final.docx&quot; ) 5.6.2 Method 2: dplyr Pipe library(dplyr) textReplace( doc_object = &quot;TLR_shell.docx&quot;, keyword = &quot;TTsubjectTT&quot;, replacement = &quot;500 participants&quot; ) %&gt;% textReplace( keyword = &quot;TTsomethingTT&quot;, replacement = &quot;Efficacy demonstrated&quot; ) %&gt;% textReplace( keyword = &quot;TTsomething2TT&quot;, replacement = &quot;Safety acceptable&quot;, return_to_file = &quot;TLR_final.docx&quot; ) 5.7 Practical Examples 5.7.1 Example 1: Population Counts library(haven) adsl &lt;- read_sas(&quot;adam/adsl.sas7bdat&quot;) n_enrolled &lt;- nrow(adsl) n_safety &lt;- sum(adsl$SAFFL == &quot;Y&quot;) n_efficacy &lt;- sum(adsl$EFFFL == &quot;Y&quot;) pop_text &lt;- sprintf( &quot;A total of %d participants were enrolled. The safety population included %d participants.&quot;, n_enrolled, n_safety ) textReplace( doc_object = &quot;TLR_shell.docx&quot;, keyword = &quot;TTpopulationTT&quot;, replacement = pop_text, return_to_file = &quot;TLR_updated.docx&quot; ) 5.7.2 Example 2: Efficacy Results response_rate_trt &lt;- 0.45 response_rate_pbo &lt;- 0.30 efficacy_text &lt;- sprintf( &quot;The response rate was %.1f%% in treatment vs %.1f%% in placebo.&quot;, response_rate_trt * 100, response_rate_pbo * 100 ) textReplace( doc_object = doc, keyword = &quot;TTefficacyTT&quot;, replacement = efficacy_text ) 5.8 Complete Workflow Example library(RapTLR) library(haven) adsl &lt;- read_sas(&quot;adam/adsl.sas7bdat&quot;) n_safety &lt;- sum(adsl$SAFFL == &quot;Y&quot;) mean_age &lt;- round(mean(adsl$AGE), 1) text_population &lt;- sprintf(&quot;Safety population: %d participants.&quot;, n_safety) text_demographics &lt;- sprintf(&quot;Mean age was %.1f years.&quot;, mean_age) textReplace( doc_object = &quot;TLR_shell.docx&quot;, keyword = &quot;TTpopulationTT&quot;, replacement = text_population ) |&gt; textReplace( keyword = &quot;TTdemographicsTT&quot;, replacement = text_demographics, return_to_file = &quot;TLR_final.docx&quot; ) 5.9 Combining with run_apdx() doc &lt;- run_apdx( path_TLFs = &quot;TLF_outputs/&quot;, docx_object = &quot;TLR_shell.docx&quot;, keyword = &quot;LISTOFAPPENDICES&quot; ) doc &lt;- textReplace(doc, keyword = &quot;TTsubjectTT&quot;, replacement = &quot;500 participants&quot;) doc &lt;- textReplace(doc, keyword = &quot;TTefficacyTT&quot;, replacement = &quot;Primary endpoint met&quot;) print(doc, target = &quot;TLR_complete.docx&quot;) 5.10 Best Practices Use sprintf() for formatting Calculate all values first Test with simple examples Keep a keyword registry Use meaningful keywords "],["creating-text.html", "Chapter 6 Creating Text with R 6.1 The fct_var_text() Function 6.2 What Does It Do? 6.3 Basic Usage 6.4 Function Parameters 6.5 Label Formats 6.6 Advanced Features 6.7 Practical Examples 6.8 Complete Workflow 6.9 Integration with Full TLR Workflow 6.10 Best Practices 6.11 Tips", " Chapter 6 Creating Text with R 6.1 The fct_var_text() Function RapTLR includes fct_var_text() to automatically create formatted text descriptions of categorical variable distributions. 6.2 What Does It Do? Converts this: table(adsl$RACE) # WHITE BLACK ASIAN OTHER # 150 80 50 20 Into this: &quot;White (n=150; 50%), Black (n=80; 26.7%), Asian (n=50; 16.7%) and Other (n=20; 6.7%)&quot; 6.3 Basic Usage library(RapTLR) # Simple distribution fct_var_text( arg_dataset = tlr_adsl, arg_var_rest = RACE ) Output: \"WHITE (n=150), BLACK (n=80), ASIAN (n=50) and OTHER (n=20)\" 6.4 Function Parameters arg_text_desc - Prefix text (default: ““) arg_dataset - Data frame containing the variable arg_fl_rest - Optional filtering condition arg_var_rest - Unquoted variable name to analyze arg_order - Sort by frequency? (default: FALSE) arg_cvt_stg - Function to apply to labels (default: identity) arg_nbr_obs - Number of levels to include (default: Inf) arg_lbl - Format: “nbr”, “pct”, or “nbr-pct” 6.5 Label Formats 6.5.1 Show Counts Only fct_var_text( arg_dataset = tlr_adsl, arg_var_rest = RACE, arg_lbl = &quot;nbr&quot; ) Output: \"WHITE (n=150), BLACK (n=80), ASIAN (n=50) and OTHER (n=20)\" 6.5.2 Show Percentages Only fct_var_text( arg_dataset = tlr_adsl, arg_var_rest = RACE, arg_lbl = &quot;pct&quot; ) Output: \"WHITE (50%), BLACK (26.7%), ASIAN (16.7%) and OTHER (6.7%)\" 6.5.3 Show Both fct_var_text( arg_dataset = tlr_adsl, arg_var_rest = RACE, arg_lbl = &quot;nbr-pct&quot; ) Output: \"WHITE (n=150; 50%), BLACK (n=80; 26.7%) and ASIAN (n=50; 16.7%)\" 6.6 Advanced Features 6.6.1 Add Descriptive Prefix fct_var_text( arg_text_desc = &quot;Patients were&quot;, arg_dataset = tlr_adsl, arg_var_rest = RACE ) Output: \"Patients were WHITE (n=150), BLACK (n=80) and ASIAN (n=50)\" 6.6.2 Sort by Frequency fct_var_text( arg_dataset = tlr_adsl, arg_var_rest = RACE, arg_order = TRUE ) Output shows most common first. 6.6.3 Limit to Top N fct_var_text( arg_dataset = tlr_adsl, arg_var_rest = RACE, arg_order = TRUE, arg_nbr_obs = 3 ) Shows only top 3 most frequent categories. 6.6.4 Convert Label Case fct_var_text( arg_dataset = tlr_adsl, arg_var_rest = RACE, arg_cvt_stg = stringr::str_to_sentence ) Output: \"White (n=150), Black (n=80) and Asian (n=50)\" 6.6.5 Filter Data First fct_var_text( arg_dataset = tlr_adsl, arg_fl_rest = SAFFL == &quot;Y&quot;, arg_var_rest = RACE ) Analyzes only safety population. 6.7 Practical Examples 6.7.1 Example 1: Demographics Description race_text &lt;- fct_var_text( arg_text_desc = &quot;The study population was&quot;, arg_dataset = adsl, arg_var_rest = RACE, arg_cvt_stg = stringr::str_to_lower, arg_lbl = &quot;pct&quot; ) textReplace( doc_object = doc, keyword = &quot;TTraceTT&quot;, replacement = race_text ) 6.7.2 Example 2: Discontinuation Reasons disc_text &lt;- fct_var_text( arg_text_desc = &quot;The most common reasons for discontinuation were:&quot;, arg_dataset = adsl, arg_fl_rest = DISCONFL == &quot;Y&quot;, arg_var_rest = DCREASCD, arg_order = TRUE, arg_nbr_obs = 3, arg_cvt_stg = stringr::str_to_lower, arg_lbl = &quot;nbr-pct&quot; ) textReplace( doc_object = doc, keyword = &quot;TTdiscontinuationTT&quot;, replacement = disc_text ) 6.7.3 Example 3: Adverse Event Summary ae_text &lt;- fct_var_text( arg_text_desc = &quot;The most frequent adverse events were&quot;, arg_dataset = adae, arg_var_rest = AEDECOD, arg_order = TRUE, arg_nbr_obs = 5, arg_lbl = &quot;nbr-pct&quot; ) 6.8 Complete Workflow library(RapTLR) library(haven) library(stringr) adsl &lt;- read_sas(&quot;adam/adsl.sas7bdat&quot;) # Create multiple text descriptions race_text &lt;- fct_var_text( arg_text_desc = &quot;Patients were&quot;, arg_dataset = adsl, arg_var_rest = RACE, arg_cvt_stg = str_to_lower, arg_lbl = &quot;pct&quot; ) country_text &lt;- fct_var_text( arg_text_desc = &quot;The top enrollment countries were&quot;, arg_dataset = adsl, arg_var_rest = COUNTRY, arg_order = TRUE, arg_nbr_obs = 5, arg_lbl = &quot;nbr&quot; ) # Replace in document textReplace( doc_object = &quot;TLR_shell.docx&quot;, keyword = &quot;TTraceTT&quot;, replacement = race_text ) |&gt; textReplace( keyword = &quot;TTcountryTT&quot;, replacement = country_text, return_to_file = &quot;TLR_final.docx&quot; ) 6.9 Integration with Full TLR Workflow library(RapTLR) # Step 1: Add appendices doc &lt;- run_apdx( path_TLFs = &quot;TLF_outputs/&quot;, docx_object = &quot;TLR_shell.docx&quot;, keyword = &quot;LISTOFAPPENDICES&quot; ) # Step 2: Create formatted text race_text &lt;- fct_var_text( arg_dataset = adsl, arg_var_rest = RACE, arg_lbl = &quot;nbr-pct&quot; ) # Step 3: Replace text doc &lt;- textReplace(doc, keyword = &quot;TTraceTT&quot;, replacement = race_text) # Step 4: Save print(doc, target = &quot;TLR_complete.docx&quot;) 6.10 Best Practices Use arg_order = TRUE for most common first Limit with arg_nbr_obs to avoid long lists Use str_to_lower or str_to_sentence for readability Choose appropriate label format for context Filter data with arg_fl_rest when needed 6.11 Tips Test output in console before using in document Combine with sprintf() for more complex sentences Use consistent case conversion across document Consider your audience when choosing format You now have all the tools to create complete, automated TLRs! "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
